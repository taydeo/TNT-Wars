package com.rast.tntwars.systems;

import java.util.Random;

import org.bukkit.Bukkit;
import org.bukkit.entity.Player;

import com.rast.tntwars.TNTWarsMain;

/**
 * This class contains methods to start the game.
 * 
 * @author Raster556
 */

public class GameInitializer {

	public static void addPlayerToGame (Player player) {
		int teamOneCount = TNTWarsMain.playerGroupManager.teamOneCount;
		int teamTwoCount = TNTWarsMain.playerGroupManager.teamTwoCount;
		
		// Balance the way we put players in teams and do a straw pull when the teams are equally full
		if (teamOneCount < teamTwoCount) {
			TNTWarsMain.playerGroupManager.addToGroup(player, "teamOne");
			PlayerTeleportManager.teleportTeamOneIsland(player, true);
			teamOneJoinBroadcast(player.getName());
		} else if (teamOneCount > teamTwoCount) {
			TNTWarsMain.playerGroupManager.addToGroup(player, "teamTwo");
			PlayerTeleportManager.teleportTeamTwoIsland(player, true);
			teamTwoJoinBroadcast(player.getName());
		} else {
			Random rand = new Random(System.currentTimeMillis());
			boolean strawPull = rand.nextBoolean();
			
			if (strawPull) {
				TNTWarsMain.playerGroupManager.addToGroup(player, "teamOne");
				PlayerTeleportManager.teleportTeamOneIsland(player, true);
				teamOneJoinBroadcast(player.getName());
			} else {
				TNTWarsMain.playerGroupManager.addToGroup(player, "teamTwo");
				PlayerTeleportManager.teleportTeamTwoIsland(player, true);
				teamTwoJoinBroadcast(player.getName());
			}
			
		}
		
	}
	
	private static void teamOneJoinBroadcast (String name) {
		Bukkit.broadcastMessage(TNTWarsMain.configEngine.teamOneColor + name + " has joined the " + TNTWarsMain.configEngine.teamOneName + " team!");
	}
	
	private static void teamTwoJoinBroadcast (String name) {
		Bukkit.broadcastMessage(TNTWarsMain.configEngine.teamTwoColor + name + " has joined the " + TNTWarsMain.configEngine.teamTwoName + " team!");
	}
	
}
